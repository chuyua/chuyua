<!DOCTYPE html><html><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.ico"><link rel="icon" type="image/png" href="/img/favicon.ico"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests"><meta name="theme-color" content="#2f4154"><meta name="description" content="小白 | OIer | 科技生活 | 大学"><meta name="author" content="Lioil"><meta name="keywords" content="Lioil"><title>最大公约数算法之横向评测 - Lioil</title><link href="https://fonts.dogedoge.com/css2?family=Noto+Sans+SC:wght@400;700&display=swap" rel="stylesheet" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="https://at.alicdn.com/t/font_1736904_lru2zlw1wl8.css"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/css/custom.css"><meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="Lioil" type="application/atom+xml"></head><body><header style="height:80vh"><a id="mdark" onclick="switchDarkMode()"></a><script>var isNight=22<=(new Date).getHours()||(new Date).getHours()<=7;!matchMedia("(prefers-color-scheme: dark)").matches&&!isNight&&"1"!==localStorage.getItem("dark")||isNight&&"1"===localStorage.getItem("noDark")||document.body.classList.add("dark")</script><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/"><strong>Royce's world</strong></a> <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="https://dl.linik.ml/" target="_blank" rel="noopener"><i class="iconfont icon-plane"></i> 开往</a></li><li class="nav-item"><a class="nav-link" href="/tags/"><i class="iconfont icon-tags-fill"></i> 标签</a></li><li class="nav-item"><a class="nav-link" href="/messageboard/"><i class="iconfont icon-liuyan"></i> 留言</a></li><li class="nav-item"><a class="nav-link" href="/links/"><i class="iconfont icon-link-fill"></i> 友链</a></li><li class="nav-item"><a class="nav-link" href="/about/"><i class="iconfont icon-user-fill"></i> 关于</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="iconfont icon-explore-fill"></i> 探索</a><div class="dropdown-menu" aria-labelledby="navbarDropdown"><a class="dropdown-item" href="/artitalk/"><i class="iconfont icon-shiguangji"></i> 时光机 </a><a class="dropdown-item" href="/archive/"><i class="iconfont icon-archive-fill"></i> 归档 </a><a class="dropdown-item" href="/gallery/"><i class="iconfont icon-xiangce1"></i> 相册</a></div></li><li class="nav-item"><a id="dark" class="nav-link" onclick="switchDarkMode()"></a></li></ul></div></div></nav><script>document.getElementById("dark").innerHTML=document.querySelector("body").classList.contains("dark")?'<i class="iconfont icon-moon"></i>':'<i class="iconfont icon-sun"></i>',document.getElementById("mdark").innerHTML=document.querySelector("body").classList.contains("dark")?'<i class="iconfont icon-moon"></i>':'<i class="iconfont icon-sun"></i>'</script><div class="view intro-2" id="background" parallax="true" style="background:url(https://rmt.dogedoge.com/fetch/royce/storage/bg/1.jpg?fmt=webp) no-repeat center center;background-size:cover"><div class="view intro-2" id="background"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="container text-center white-text fadeInUp"><span class="h2" id="subtitle"></span><div class="mt-3 post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2020-02-09 23:43">Sun Feb 09 2020</time></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 2.9k</span></div></div></div></div></div></div></header><main><div class="container-fluid"><div class="row"><div class="d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-md"><div class="container nopadding-md" id="board-ctn"><div class="py-5" id="board"><div class="post-content mx-auto" id="post"><article class="markdown-body"><p>最大公约数<br>简称 <code>Gcd</code><br>当然还有一个简称 <code>hcf</code> 嘿嘿嘿<br>（可我不敢用 hcf QAQ）</p><p>求法有好多种</p><ul><li>穷举法</li><li>碾转相除法</li><li><ul><li>欧几里得算法</li></ul></li><li><ul><li>扩展欧几里得算法</li></ul></li><li>Stein 算法</li><li>碾转相减法</li><li>利用位运算（不知道叫什么，非常快就对了）</li></ul><a id="more"></a><h1 id="算法介绍"><a class="markdownIt-Anchor" href="#算法介绍"></a> 算法介绍</h1><h2 id="1-穷举法"><a class="markdownIt-Anchor" href="#1-穷举法"></a> 1. 穷举法</h2><p>没什么说的</p><h3 id="代码实现"><a class="markdownIt-Anchor" href="#代码实现"></a> 代码实现</h3><div class="hljs"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">Gcd1</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b)</span> </span>&#123;
	<span class="hljs-keyword">int</span> Gcd = <span class="hljs-number">1</span>, minn = min(a, b);
	<span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=<span class="hljs-number">2</span>; i&lt;=minn; i++)
        <span class="hljs-keyword">if</span> (!a%i &amp;&amp; !b%i)
            Gcd = i;
	<span class="hljs-keyword">return</span> Gcd;
&#125;</code></pre></div><h2 id="2-辗转相除法"><a class="markdownIt-Anchor" href="#2-辗转相除法"></a> 2. 辗转相除法</h2><p>又称为 <code>欧几里得算法</code></p><h3 id="公式"><a class="markdownIt-Anchor" href="#公式"></a> 公式</h3><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi><mi>c</mi><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mtext>  </mtext><mi>b</mi><mo stretchy="false">)</mo><mo>=</mo><mi>G</mi><mi>c</mi><mi>d</mi><mo stretchy="false">(</mo><mi>b</mi><mo separator="true">,</mo><mtext>  </mtext><mi>a</mi><mtext>  </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext>  </mtext><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Gcd(a,\;b) = Gcd(b,\;a\;mod\;b)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">G</span><span class="mord mathdefault">c</span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord mathdefault">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">G</span><span class="mord mathdefault">c</span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord mathdefault">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord mathdefault">b</span><span class="mclose">)</span></span></span></span></span></p><p>其中，a <code>mod</code> b是a除以b所得的余数。</p><h3 id="证明"><a class="markdownIt-Anchor" href="#证明"></a> 证明</h3><blockquote><ol><li><p>充分性：<br>设 g 是 a,b 的公约数，则 a,b 可由 g 来表示：<br>a = xg, b = yg (x,y为整数)<br>又，a 可由 b 表示（任意一个数都可以由另一个数来表示）：<br>a = kb + r (k 为整数，r 为 a 除以 b 所得余数)<br>=&gt; r = a - kb = xg - kyg = (x - ky)g<br>即，g 也是 r 的约数。<br>这样，g 就是 (b, r) 即 (b, a mod b) 的公约数。</p></li><li><p>必要性：<br>设g是 (b, a mod b) 的公约数，类似于 1.，同样可以推出 g 也是 (a, b) 的公约数。</p></li></ol><p>综合 1.2.可得 (a, b) 和 (b, a mod b) 的公约数是一样的，当然最大公约数也是一样的。</p></blockquote><p>代码如下:</p><div class="hljs"><pre><code class="hljs cpp"><span class="hljs-comment">// 碾转相除(递归写法)</span>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">Gcd2</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b)</span> </span>&#123;
    <span class="hljs-keyword">if</span> (!b) <span class="hljs-keyword">return</span> a;
    <span class="hljs-keyword">return</span> Gcd2(b, a % b);
&#125;

<span class="hljs-comment">//碾转相除(迭代写法)</span>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">Gcd3</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b)</span> </span>&#123;
    <span class="hljs-keyword">while</span>(b) &#123;
        <span class="hljs-keyword">int</span> t = b;
        b = a % b;
        a = t;
    &#125;
    <span class="hljs-keyword">return</span> a;
&#125;</code></pre></div><p>补充:<br>（看大佬博客发现的，以下内容均来自 <a href="https://baike.baidu.com/item/%E6%89%A9%E5%B1%95%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E7%AE%97%E6%B3%95/2029414?fromtitle=%60%E6%89%A9%E5%B1%95%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%B7%E7%AE%97%E6%B3%95%60&amp;fromid=1053275" target="_blank" rel="noopener external nofollow noreferrer">百度百科</a>和 <a href="https://www.cnblogs.com/drizzlecrj/archive/2007/09/14/892340.html" target="_blank" rel="noopener external nofollow noreferrer">大佬博客</a>）<br><code>扩展欧几里得算法</code>（英语：Extended Euclidean algorithm）是<code>欧几里得算法</code>（又叫辗转相除法）的扩展。<br>已知整数 a、b，<code>扩展欧几里得算法</code>可以在求得a、b的最大公约数的同时，能找到整数 x、y （其中一个很可能是负数），使它们满足<code>贝祖等式</code>，即</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mi>x</mi><mo>+</mo><mi>b</mi><mi>y</mi><mo>=</mo><mi>G</mi><mi>c</mi><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mtext>  </mtext><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">ax + by = Gcd(a,\;b)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.66666em;vertical-align:-.08333em"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault">b</span><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">G</span><span class="mord mathdefault">c</span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord mathdefault">b</span><span class="mclose">)</span></span></span></span></span></p><p>如果 a 是负数，可以把问题转化成</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∣</mi><mi>a</mi><mi mathvariant="normal">∣</mi><mo stretchy="false">(</mo><mo>−</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><mi>b</mi><mi>y</mi><mo>=</mo><mi>G</mi><mi>c</mi><mi>d</mi><mo stretchy="false">(</mo><mi mathvariant="normal">∣</mi><mi>a</mi><mi mathvariant="normal">∣</mi><mo separator="true">,</mo><mtext>  </mtext><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">| a | ( -x ) + by = Gcd(| a |,\;b)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">∣</span><span class="mord mathdefault">a</span><span class="mord">∣</span><span class="mopen">(</span><span class="mord">−</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault">b</span><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">G</span><span class="mord mathdefault">c</span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord">∣</span><span class="mord mathdefault">a</span><span class="mord">∣</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord mathdefault">b</span><span class="mclose">)</span></span></span></span></span></p><p>然后令x’ = (-x)。</p><p>通常谈到最大公约数时，我们都会提到一个非常基本的事实：给予二个整数 a、b，必存在整数 x、y 使得 ax + by = Gcd(a,b)。<br>有两个数 a,b，对它们进行辗转相除法，可得它们的最大公约数——这是众所周知的。然后，收集辗转相除法中产生的式子，倒回去，可以得到 ax+by=Gcd (a,b) 的整数解。<br>扩展欧几里得算法可以用来计算模反元素(也叫模逆元)，而模反元素在 <code>RSA</code> 加密算法中有举足轻重的地位。</p><p>代码如下:</p><div class="hljs"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">exGcd</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b, <span class="hljs-keyword">int</span> &amp;x, <span class="hljs-keyword">int</span> &amp;y)</span> </span>&#123;
    <span class="hljs-keyword">if</span>(b == <span class="hljs-number">0</span>) &#123;
        x = <span class="hljs-number">1</span>;
        y = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">return</span> a;
    &#125;
    <span class="hljs-keyword">int</span> r = exGcd(b, a % b, x, y);
    <span class="hljs-keyword">int</span> t = x;
    x = y;
    y = t - a / b * y;
    <span class="hljs-keyword">return</span> r;
&#125;</code></pre></div><p>把这个实现和 Gcd 的递归实现相比，发现多了下面的 x,y 赋值过程，这就是扩展欧几里德算法的精髓。<br>可以这样思考:<br>对于</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>a</mi><mo mathvariant="normal">′</mo></msup><mo>=</mo><mi>b</mi><mo separator="true">,</mo><msup><mi>b</mi><mo mathvariant="normal">′</mo></msup><mo>=</mo><mi>a</mi><mi mathvariant="normal">%</mi><mi>b</mi></mrow><annotation encoding="application/x-tex">a&#x27; = b, b&#x27; = a \% b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.801892em;vertical-align:0"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.801892em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.996332em;vertical-align:-.19444em"></span><span class="mord mathdefault">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.801892em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.80556em;vertical-align:-.05556em"></span><span class="mord mathdefault">a</span><span class="mord">%</span><span class="mord mathdefault">b</span></span></span></span></span></p><p>而言，我们求得 x, y使得</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>a</mi><mo mathvariant="normal">′</mo></msup><mi>x</mi><mo>+</mo><msup><mi>b</mi><mo mathvariant="normal">′</mo></msup><mi>y</mi><mo>=</mo><mi>G</mi><mi>c</mi><mi>d</mi><mo stretchy="false">(</mo><msup><mi>a</mi><mo mathvariant="normal">′</mo></msup><mo separator="true">,</mo><msup><mi>b</mi><mo mathvariant="normal">′</mo></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a&#x27;x + b&#x27;y = Gcd(a&#x27;, b&#x27;)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8852220000000001em;vertical-align:-.08333em"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.801892em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.996332em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.801892em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.051892em;vertical-align:-.25em"></span><span class="mord mathdefault">G</span><span class="mord mathdefault">c</span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.801892em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.801892em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>由于</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>b</mi><mo mathvariant="normal">′</mo></msup><mo>=</mo><mi>a</mi><mi mathvariant="normal">%</mi><mi>b</mi><mo>=</mo><mi>a</mi><mo>−</mo><mi>a</mi><mi mathvariant="normal">/</mi><mi>b</mi><mo>∗</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">b&#x27; = a \% b = a - a / b * b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.801892em;vertical-align:0"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.801892em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.80556em;vertical-align:-.05556em"></span><span class="mord mathdefault">a</span><span class="mord">%</span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.66666em;vertical-align:-.08333em"></span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">a</span><span class="mord">/</span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault">b</span></span></span></span></span></p><p>(注：这里的/是程序设计语言中的除法)<br>那么可以得到:</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>a</mi><mo mathvariant="normal">′</mo></msup><mi>x</mi><mo>+</mo><msup><mi>b</mi><mo mathvariant="normal">′</mo></msup><mi>y</mi><mo>=</mo><mi>G</mi><mi>c</mi><mi>d</mi><mo stretchy="false">(</mo><msup><mi>a</mi><mo mathvariant="normal">′</mo></msup><mo separator="true">,</mo><msup><mi>b</mi><mo mathvariant="normal">′</mo></msup><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mo>⟹</mo><mi>b</mi><mi>x</mi><mo>+</mo><mo stretchy="false">(</mo><mi>a</mi><mo>−</mo><mi>a</mi><mi mathvariant="normal">/</mi><mi>b</mi><mo>∗</mo><mi>b</mi><mo stretchy="false">)</mo><mi>y</mi><mo>=</mo><mi>G</mi><mi>c</mi><mi>d</mi><mo stretchy="false">(</mo><msup><mi>a</mi><mo mathvariant="normal">′</mo></msup><mo separator="true">,</mo><msup><mi>b</mi><mo mathvariant="normal">′</mo></msup><mo stretchy="false">)</mo><mo>=</mo><mi>G</mi><mi>c</mi><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mo>⟹</mo><mi>a</mi><mi>y</mi><mo>+</mo><mi>b</mi><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><mi>a</mi><mi mathvariant="normal">/</mi><mi>b</mi><mo>∗</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>G</mi><mi>c</mi><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a&#x27;x + b&#x27;y = Gcd(a&#x27;, b&#x27;)\\⟹ bx + (a - a / b * b)y = Gcd(a&#x27;, b&#x27;) = Gcd(a, b)\\⟹ ay +b(x - a / b*y) = Gcd(a, b)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8852220000000001em;vertical-align:-.08333em"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.801892em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.996332em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.801892em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.051892em;vertical-align:-.25em"></span><span class="mord mathdefault">G</span><span class="mord mathdefault">c</span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.801892em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.801892em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:.549em;vertical-align:-.024em"></span><span class="mrel">⟹</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.77777em;vertical-align:-.08333em"></span><span class="mord mathdefault">b</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">a</span><span class="mord">/</span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">b</span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.051892em;vertical-align:-.25em"></span><span class="mord mathdefault">G</span><span class="mord mathdefault">c</span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.801892em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.801892em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">G</span><span class="mord mathdefault">c</span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathdefault">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:.549em;vertical-align:-.024em"></span><span class="mrel">⟹</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">b</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">a</span><span class="mord">/</span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">G</span><span class="mord mathdefault">c</span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathdefault">b</span><span class="mclose">)</span></span></span></span></span></p><p>因此对于 a 和 b 而言，他们的相对应的 p，q 分别是 y 和 (x-a/b*y)</p><h2 id="3-stein-算法"><a class="markdownIt-Anchor" href="#3-stein-算法"></a> 3. Stein 算法</h2><p>（以下内容参考 <a href="https://www.cnblogs.com/drizzlecrj/archive/2007/09/14/892340.html" target="_blank" rel="noopener external nofollow noreferrer">大佬博客</a>）</p><h3 id="欧几里得算法缺陷"><a class="markdownIt-Anchor" href="#欧几里得算法缺陷"></a> 欧几里得算法缺陷</h3><p>欧几里德算法是计算两个数最大公约数的传统算法，他无论从理论还是从效率上都是很好的。但是他有一个致命的缺陷，这个缺陷只有在大素数时才会显现出来。</p><p>考虑现在的硬件平台，一般整数最多也就是 64 位，对于这样的整数，计算两个数之间的模是很简单的。对于字长为 32 位的平台，计算两个不超过32位的整数的模，只需要一个指令周期，而计算 64 位以下的整数模，也不过几个周期而已。但是对于更大的素数，这样的计算过程就不得不由用户来设计，为了计算两个超过 64 位的整数的模，用户也许不得不采用类似于多位数除法手算过程中的试商法，这个过程不但复杂，而且消耗了很多 CPU 时间。对于现代密码算法，要求计算 128 位以上的素数的情况比比皆是，设计这样的程序迫切希望能够<font color="red">抛弃除法和取模</font>。 （注：说到抛弃除法和取模，其实辗转相除法可以写成减法的形式）</p><h3 id="算法思想"><a class="markdownIt-Anchor" href="#算法思想"></a> 算法思想</h3><p>Stein 算法由 J. Stein 1961 年提出，这个方法也是计算两个数的最大公约数。和欧几里德算法 算法不同的是，Stein 算法只有整数的移位和加减法，这对于程序设计者是一个福音。</p><p>为了说明 Stein 算法的正确性，首先必须注意到以下结论：</p><p>Gcd(a,a) = a，也就是一个数和他自身的公约数是其自身<br>Gcd(ka,kb) = k Gcd(a,b)，也就是最大公约数运算和倍乘运算可以交换，特殊的，当 k=2 时，说明两个偶数的最大公约数必然能被 2 整除。</p><h3 id="算法步骤"><a class="markdownIt-Anchor" href="#算法步骤"></a> 算法步骤</h3><p>1、如果 An=Bn,那么 An(或Bn)<em>Cn 是最大公约数,算法结束<br>2、如果 An=0，Bn 是最大公约数，算法结束<br>3、如果 Bn=0，An 是最大公约数，算法结束<br>4、设置 A1=A、B1=B 和 C1=1<br>5、如果 An 和 Bn 都是偶数，则 An+1=An/2，Bn+1=Bn/2，Cn+1=Cn</em>2 (注意，乘 2 只要把整数左移一位即可，除 2 只要把整数右移一位即可)<br>6、如果 An 是偶数，Bn 不是偶数，则 An+1=An/2，Bn+1=Bn，Cn+1=Cn(很显然啦，2 不是奇数的约数)<br>7、如果 Bn 是偶数，An 不是偶数，则 Bn+1=Bn/2，An+1=An，Cn+1=Cn(很显然啦，2 不是奇数的约数)<br>8、如果 An 和 Bn 都不是偶数，则 An+1=|An-Bn|/2，Bn+1=min(An,Bn)，Cn+1=Cn<br>9、n 加 1，转 1</p><h3 id="c的实现"><a class="markdownIt-Anchor" href="#c的实现"></a> C++的实现:</h3><div class="hljs"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">Gcd4</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b)</span> </span>&#123;
    <span class="hljs-keyword">if</span>(a == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> b;
    <span class="hljs-keyword">if</span>(b == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> a;
    <span class="hljs-keyword">if</span>(a % <span class="hljs-number">2</span> == <span class="hljs-number">0</span> &amp;&amp; b % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">2</span> * Gcd4(a &gt;&gt; <span class="hljs-number">1</span>, b &gt;&gt; <span class="hljs-number">1</span>);
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(a % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>)  <span class="hljs-keyword">return</span> Gcd4(a &gt;&gt; <span class="hljs-number">1</span>, b);
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(b % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> Gcd4(a, b &gt;&gt; <span class="hljs-number">1</span>);
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> Gcd4(<span class="hljs-built_in">abs</span>(a - b), min(a, b));
&#125;</code></pre></div><p>考虑欧几里德算法，最恶劣的情况是，每次迭代 a = 2b -1,这样，迭代后，r= b-1。如果 a 小于 2N，这样大约需要 4N 次迭代。而考虑 Stein 算法，每次迭代后，显然 AN+1BN+1≤ ANBN/2，最大迭代次数也不超过 4N 次。也就是说，迭代次数几乎是相等的。但是，需要注意的是，对于大素数，试商法将使每次迭代都更复杂，因此<font color="red">对于大素数 Stein 将更有优势</font></p><h2 id="4-辗转相减法"><a class="markdownIt-Anchor" href="#4-辗转相减法"></a> 4. 辗转相减法</h2><p>即尼考曼彻斯法</p><p>若 a &gt; b，则 a = a - b<br>若 b &gt; a，则 b = b - a<br>若 a == b，则 a(或b) 即为最大公约数<br>若 a != b，则回到 1</p><h3 id="证明-2"><a class="markdownIt-Anchor" href="#证明-2"></a> 证明</h3><blockquote><p>设<br>a = bq1 + r1 (0 &lt; r1 &lt; b)<br>b = r1q2 + r2 (0 &lt; r2 &lt; r1)<br>r1 = r2q3 + r3 (0 &lt; r3 &lt; r2)<br>……<br>只要 r1, r2, r3…… 不是 0 就可以继续写下去<br>我们看到：<br>b &gt; r1 &gt; r2 &gt; r3 &gt; …… &gt; 0<br>b 是有限的 r1, r2, r3 是整数<br>所以至多 b 步后，必有 rn = 0<br>rn - 2 = rn - 1qn + rn<br>rn - 1 = rn * qn + 1 + 0<br>由此可以得到 (a, b) = rn<br>(来自百度百科)</p></blockquote><h3 id="代码实现-2"><a class="markdownIt-Anchor" href="#代码实现-2"></a> 代码实现</h3><div class="hljs"><pre><code class="hljs cpp"><span class="hljs-comment">// 辗转相减法（递归写法）</span>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">Gcd5</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b)</span> </span>&#123;
    <span class="hljs-keyword">if</span>(a == b) <span class="hljs-keyword">return</span> a;
    <span class="hljs-keyword">return</span> a &gt; b ? Gcd5(a-b, b) : Gcd5(a, b-a);
&#125;

<span class="hljs-comment">// 辗转相减法（迭代写法）</span>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">Gcd6</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b)</span> </span>&#123;
    <span class="hljs-keyword">while</span>(a != b) &#123;
        <span class="hljs-keyword">if</span>(a &gt; b)
            a = a - b;
        <span class="hljs-keyword">else</span>
            b = b - a;
    &#125;
    <span class="hljs-keyword">return</span> a;
&#125;</code></pre></div><h2 id="5利用位运算"><a class="markdownIt-Anchor" href="#5利用位运算"></a> 5.利用位运算</h2><p>不会证明，也没找到证明，直接上代码</p><h3 id="代码实现-3"><a class="markdownIt-Anchor" href="#代码实现-3"></a> 代码实现</h3><div class="hljs"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">Gcd7</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b)</span> </span>&#123;
　　<span class="hljs-keyword">while</span>(b^=a^=b^=a%=b);
　　<span class="hljs-keyword">return</span> a;
&#125;</code></pre></div><p>是不是超短，但是非常快</p><h1 id="运行时间对比"><a class="markdownIt-Anchor" href="#运行时间对比"></a> 运行时间对比</h1><div class="hljs"><pre><code class="hljs cpp"><span class="hljs-comment">// 测试代码</span>
<span class="hljs-comment">// 对于同种算法仅测试递归写法</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;windows.h&gt;</span></span>

<span class="hljs-comment">// 穷举法</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Gcd1</span><span class="hljs-params">(<span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> a, <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> b)</span> </span>&#123;
    <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> Gcd = <span class="hljs-number">1</span>, minn = <span class="hljs-built_in">std</span>::min(a, b);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> i=<span class="hljs-number">2</span>; i&lt;=minn; i++)
        <span class="hljs-keyword">if</span> (!a%i &amp;&amp; !b%i)
            Gcd = i;
&#125;

<span class="hljs-comment">// 碾转相除(递归写法)</span>
<span class="hljs-function"><span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> <span class="hljs-title">Gcd2</span><span class="hljs-params">(<span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> a, <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> b)</span> </span>&#123;
    <span class="hljs-keyword">if</span> (!b) <span class="hljs-keyword">return</span> a;
    <span class="hljs-keyword">return</span> Gcd2(b, a % b);
&#125;


<span class="hljs-function"><span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> <span class="hljs-title">Gcd4</span><span class="hljs-params">(<span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> a, <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> b)</span> </span>&#123;
    <span class="hljs-keyword">if</span>(a == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> b;
    <span class="hljs-keyword">if</span>(b == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> a;
    <span class="hljs-keyword">if</span>(a % <span class="hljs-number">2</span> == <span class="hljs-number">0</span> &amp;&amp; b % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">2</span> * Gcd4(a &gt;&gt; <span class="hljs-number">1</span>, b &gt;&gt; <span class="hljs-number">1</span>);
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(a % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>)  <span class="hljs-keyword">return</span> Gcd4(a &gt;&gt; <span class="hljs-number">1</span>, b);
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(b % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> Gcd4(a, b &gt;&gt; <span class="hljs-number">1</span>);
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> Gcd4(<span class="hljs-built_in">abs</span>(a - b), <span class="hljs-built_in">std</span>::min(a, b));
&#125;

<span class="hljs-comment">// 辗转相减法（递归写法）</span>
<span class="hljs-function"><span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> <span class="hljs-title">Gcd5</span><span class="hljs-params">(<span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> a, <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> b)</span> </span>&#123;
    <span class="hljs-keyword">if</span>(a == b) <span class="hljs-keyword">return</span> a;
    <span class="hljs-keyword">return</span> a &gt; b ? Gcd5(a-b, b) : Gcd5(a, b-a);
&#125;

<span class="hljs-function"><span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> <span class="hljs-title">Gcd7</span><span class="hljs-params">(<span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> a, <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> b)</span> </span>&#123;
    <span class="hljs-keyword">while</span>(b^=a^=b^=a%=b);
    <span class="hljs-keyword">return</span> a;
&#125;

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;
    <span class="hljs-keyword">double</span> time=<span class="hljs-number">0</span>;
    LARGE_INTEGER nFreq;
    LARGE_INTEGER nBeginTime;
    LARGE_INTEGER nEndTime;
    QueryPerformanceFrequency(&amp;nFreq);
    QueryPerformanceCounter(&amp;nBeginTime);

    <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> a = <span class="hljs-number">77353649739</span>;
    <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> b = <span class="hljs-number">2147483647</span>;
    Gcd1(a, b);

    QueryPerformanceCounter(&amp;nEndTime);
    time=(<span class="hljs-keyword">double</span>)(nEndTime.QuadPart-nBeginTime.QuadPart)/(<span class="hljs-keyword">double</span>)nFreq.QuadPart;
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span>&lt;&lt;<span class="hljs-string">"运行时间："</span>&lt;&lt;time*<span class="hljs-number">1000</span>&lt;&lt;<span class="hljs-string">"ms\n"</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre></div><p>结果：</p><blockquote><p>Gcd1(a, b) 运行时间：14641.3 ms<br>Gcd2(a, b) 运行时间：0.0007 ms<br>Gcd4(a, b) 运行时间：0.0051 ms<br>Gcd5(a, b) 运行时间：0.0057 ms<br>Gcd6(a, b) 运行时间：0.0017 ms<br>Gcd7(a, b) 运行时间：0.0007 ms</p></blockquote><p>可见<code>辗转相除法</code>与<code>利用位运算</code>的两个算法最快。</p><p>那么加大数据，再次比较这两种算法</p><div class="hljs"><pre><code class="hljs cpp"><span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> a = <span class="hljs-number">18446344013706551617</span>;
<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> b = <span class="hljs-number">12416744005372551613</span>;</code></pre></div><p>多次运行结果：</p><blockquote><p>Gcd2(a, b) 运行时间：0.0007~0.0008 ms</p><p>Gcd7(a, b) 运行时间：0.0002~0.0005 ms</p></blockquote><p>可见利用位运算的算法是最快的，<s>又短又快</s> 嘿嘿嘿</p><h1 id="220更新"><a class="markdownIt-Anchor" href="#220更新"></a> 2.20更新</h1><p>加大数据，并用 Linux 内置 time 测试时间</p><p>数据越加越大</p><div class="hljs"><pre><code class="hljs angelscript"><span class="hljs-comment">//辗转相除</span>
real    <span class="hljs-number">0</span>m0<span class="hljs-number">.014</span>s
user    <span class="hljs-number">0</span>m0<span class="hljs-number">.000</span>s
sys     <span class="hljs-number">0</span>m0<span class="hljs-number">.016</span>s

<span class="hljs-comment">//位运算</span>
real    <span class="hljs-number">0</span>m0<span class="hljs-number">.013</span>s
user    <span class="hljs-number">0</span>m0<span class="hljs-number">.000</span>s
sys     <span class="hljs-number">0</span>m0<span class="hljs-number">.016</span>s</code></pre></div><p>好像也没差多少啊？</p><p>还是我测的方法不对</p><p>测试方法如下：</p><p>两个方法分两个文件写</p><div class="hljs"><pre><code class="hljs cpp"><span class="hljs-comment">//test1</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;iostream&gt;</span></span>
<span class="hljs-function"><span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> <span class="hljs-title">Gcd</span><span class="hljs-params">(<span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> a, <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> b)</span> </span>&#123;
    <span class="hljs-keyword">if</span> (!b) <span class="hljs-keyword">return</span> a;
    <span class="hljs-keyword">return</span> Gcd(b, a % b);
&#125;
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;

    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> a = <span class="hljs-number">1844674407370955143</span>;
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> b = <span class="hljs-number">1844674407370955137</span>;
    Gcd(a, b);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre></div><div class="hljs"><pre><code class="hljs cpp"><span class="hljs-comment">//test2</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;iostream&gt;</span></span>
<span class="hljs-function"><span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> <span class="hljs-title">Gcd</span><span class="hljs-params">(<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> a, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> b)</span> </span>&#123;
    <span class="hljs-keyword">while</span>(b^=a^=b^=a%=b);
    <span class="hljs-keyword">return</span> a;
&#125;
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> a = <span class="hljs-number">1844674407370955143</span>;
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> b = <span class="hljs-number">1844674407370955137</span>;
    Gcd(a, b);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre></div><p>然后命令行 <code>g++ test1.cpp -o test1</code> 和 <code>g++ test2.cpp -o test2</code></p><p>然后 <code>time ./test1</code> 和 <code>time ./test2</code></p><p>（应该没错啊）</p><hr><ol><li>部分介绍内容来源<a href="https://baike.baidu.com/" target="_blank" rel="noopener external nofollow noreferrer">百度百科</a></li></ol></article><hr><div><div class="post-metas mb-3"><div class="post-meta"><a class="hover-with-bg" href="/tags/OI/">OI</a> <a class="hover-with-bg" href="/tags/c/">c++</a> <a class="hover-with-bg" href="/tags/%E6%A8%AA%E5%90%91%E8%AF%84%E6%B5%8B/">横向评测</a></div></div></div><br><br><div class="markdown-body"><div class="text-center"><a class="btn" id="valine-btn">Valine</a> <a class="btn" id="utterances-btn">Utterances</a></div></div><div class="comments valine" id="comments"><script defer src="https://cdn.jsdelivr.net/npm/leancloud-storage@3.0.4/dist/av-min.js"></script><script defer src="https://cdn.jsdelivr.net/gh/royce003/BlogSource/js/Valine.min.js"></script><script type="text/javascript">var oldLoadVa=window.onload;window.onload=function(){oldLoadVa&&oldLoadVa(),new Valine({lang:"zh-cn",el:"#comments",app_id:"BP0WteqAi1rLTH6C13A1Jfw8-gzGzoHsz",app_key:"Xhohtk79OfxwRIBRi4ew2KhF",admin_email:"979093525@qq.com",placeholder:"说点什么...",emoticon_url:"https://rmt.dogedoge.com/fetch/royce/storage/comments",emoticon_list:["抓狂.png","无奈2.png","惊讶.png","托腮.png","快哭了.png","可怜.png","吃瓜.png","打哈欠.png","辣眼睛.png","脑阔疼.png","doge.png","动耳朵.gif","抖脚脚.gif","抖眼.gif","抖眼镜.gif","风吹秀发.gif","慌张.gif","夹住.gif","开车.gif","哭唧唧.gif","绿色的.gif","跳舞.gif","跳着走.gif","小花花.gif","眼睛转.gif","摇头.gif","眨眼.gif","吃东西.gif","弹肚皮.gif","动次打次.gif?fmt=webp ","比心心.gif","吹风.gif","打篮球.gif","都是小心心.gif","吐.png","喷血.png","狂汗.png","不说话.png","汗.png","坐等.png","献花.png","不高兴.png","中刀.png","害羞.png","皱眉.png","小眼睛.png","中指.png","尴尬.png","瞅你.png","想一想.png","中枪.png","得意.png","肿包.png","扇耳光.png","亲亲.png","惊喜.png","脸红.png","无所谓.png","便便.png","愤怒.png","蜡烛.png","献黄瓜.png","内伤.png","投降.png","观察.png","看不见.png","击掌.png","抠鼻.png","邪恶.png","看热闹.png","口水.png","抽烟.png","锁眉.png","装大款.png","吐舌.png","无奈.png","长草.png","赞一个.png","呲牙.png","无语.png","阴暗.png","不出所料.png","咽气.png","期待.png","高兴.png","吐血倒地.png","哭泣.png","欢呼.png","黑线.png","喜极而泣.png","喷水.png","深思.png","鼓掌.png","暗地观察.png"]})}</script><noscript>Please enable JavaScript to view the <a href="https://valine.js.org" target="_blank" rel="nofollow noopener noopener">comments powered by Valine.</a></noscript></div><div class="comments utterances" id="comments" style="display:none"><script defer src="https://utteranc.es/client.js" repo="chuyua/commit-utterance" issue-term="pathname" label="utterances" theme="preferred-color-scheme" crossorigin="anonymous"></script></div></div></div></div></div><div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p><div id="tocbot"></div></div></div></div></div></main><a id="scroll-top-button" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><footer class="mt-5"><div class="text-center py-3"><div><a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a></div><div>Powered by <a href="https://pages.github.com/" class="qr-trigger" target="_blank" rel="nofollow noopener">GitHub Pages</a></div><div><a href="http://beian.miit.gov.cn/" target="_blank" class="beian-icp" rel="nofollow noopener">闽ICP备20005437号-1</a></div></div></footer><script src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js"></script><script src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js"></script><script src="/js/debouncer.js"></script><script src="/js/main.js"></script><script src="/js/lazyload.js"></script><script src="https://cdn.staticfile.org/tocbot/4.11.1/tocbot.min.js"></script><script>$(document).ready(function(){var t=$("#board-ctn").offset().top;tocbot.init({tocSelector:"#tocbot",contentSelector:".post-content",headingSelector:"h1,h2,h3,h4,h5,h6",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",collapseDepth:0,scrollSmooth:!0,headingsOffset:-t}),0<$(".toc-list-item").length&&$("#toc").css("visibility","visible")})</script><script defer>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?ff40c47e72e383767b9bcd0a82d13218";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js"></script><script>var typed=new Typed("#subtitle",{strings:["  ","最大公约数算法之横向评测&nbsp;"],cursorChar:"_",typeSpeed:70,loop:!1});typed.stop(),$(document).ready(function(){$(".typed-cursor").addClass("h2"),typed.start()})</script><script src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js"></script><link rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css"><script>$("#post img:not(.no-zoom img, img[no-zoom]), img[zoom]").each(function(){var t=document.createElement("a");$(t).attr("data-fancybox","images"),$(t).attr("href",$(this).attr("src")),$(this).wrap(t)})</script><link rel="stylesheet" href="https://cdn.staticfile.org/KaTeX/0.11.1/katex.min.css"><script type="text/javascript">var a_idx=0;jQuery(document).ready(function(d){d("body").click(function(a){var o=new Array("富强","民主","文明","和谐","自由","平等","公正","法治","爱国","敬业","诚信","友善"),t=d("<span/>").text(o[a_idx]);a_idx=(a_idx+1)%o.length;var n=a.pageX,e=a.pageY;t.css({"z-index":999,top:e-20,left:n,position:"absolute","font-weight":"bold",color:"rgb("+~~(255*Math.random())+","+~~(255*Math.random())+","+~~(255*Math.random())+")"}),d("body").append(t),t.animate({top:e-180,opacity:0},1500,function(){t.remove()})})})</script></body></html>